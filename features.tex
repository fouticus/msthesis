\chapter{Features}
\label{appendix:features}

The raw data associated with protein structures are found in PDB files, which contain the protein sequence of amino acids and the atomic coordinates of each atom in each amino acid.
When performing interface prediction, a number of derived features have been found useful, which are either calculated directly from the PDB data, or from other sources such as sequence databases.
Here, the term \emph{features} describes a vector of values associated with either a vertex or edge in a graph, with vertices corresponding to amino acid residues, and edges the relationships between two residues.
The term \emph{feature} then is just a single element of the vector.
Some methods described below generate more than one feature, hence they are grouped into appropriate \emph{categories}.
This appendix describes each feature category in detail, including the number of features generated, external tools, and a description of the feature.
In addition to the tools specified for each feature category, extensive use was made of Biopython~\cite{cock2009} to parse PDB files into convenient data structures. 

\section{Vertex Features}

\subsection{Windowed Position Specific Scoring Matrix (PSSM)}
\noindent
\emph{Number of features}: 20

\noindent
\emph{External tools}: PSI-BLAST~\cite{altschul1997}

\noindent
\emph{Description}:
The PSSM is a set of features constructed from protein sequence alone, without any structural information.
It captures the relative abundance of each type of amino acid in proteins which share a similar sequence in a window around the amino acid of interest.
Proteins with similar sequences to the search window are identified through PSI-BLAST, a position specific, iterative version of BLAST, the Basic Local Alignment and Search Tool~\cite{altschul1990}.
The similar sequences are then used to generate a summary in a window around the residue of interest.
For each window position and each residue type, a score is computed by comparing the observed counts of that residue type in that window position to the expected count generated by a null model.
The score is then $\text{log}(Q_i/P_i)$ where $Q_i$ is the fraction of sequences with that residue type in that position, and $P_i$ is the expected fraction based on data-dependent pseudocounts (more detail can be found in Altschul, et al (1990)).
For this thesis, only the scores at the residue of interest were considered (a window size of one), so there are 20 features, one for each amino acid type. 

\subsection{Relative Accessible Surface Area (rASA)}
\noindent
\emph{Number of features}: 1

\noindent
\emph{External tools}: STRIDE~\cite{heinig2004}

\noindent
\emph{Description}:
Relative Accessible Surface Area, or \emph{Solvent Accessible Area}, reflects the fraction of a residue that is exposed to a potential solvent.
This is computed by sliding a spherical probe of radius of 1.4\AA{} (approximating the radius of a water molecule~\cite{eisenhaber1995}) over the van der Waals surface of the protein near the residue of interest.
The Area generated by the center of the probe as it is in contact with the residue is taken to be the accessible surface area.
This is divided by the maximum possible accessible surface area to achieve a relative measure.


\subsection{Residue Depth}
\noindent
\emph{Number of features}: 2

\noindent
\emph{External tools}: MSMS~\cite{sanner1996}

\noindent
\emph{Description}:
Residue Depth is the minimum distance from the residue to the surface of the protein, as calculated by MSMS.
The distance is calculated is two ways: by taking the average distance of all non-hydrogen atoms in the residue to the surface, and by taking the distance of the alpha carbon to the surface.


\subsection{Protrusion Index and Hydrophobicity}
\noindent
\emph{Number of features}: 6

\noindent
\emph{External tools}: PSAIA~\cite{mihel2008}

\noindent
\emph{Description}:
The protrusion index indicates the degree to which a sphere (radius 10\AA{}) centered at a non-hydrogen atom is not filled with other atoms.
$V_{int}$ is the volume occupied by atoms, which is calculated as the number of atoms times the mean atomic volume found in proteins.
$V_{ext}$ is the difference between the total sphere volume and $V_{int}$. 
The protrusion index is defined as $V_{ext}/V_{int}$.
This value is calculated for each non-hydrogen atom in the residue, then the following summary statistics are taken:
\begin{itemize}
	\item \emph{Total mean}: the average over all non-hydrogen atoms in the residue
	\item \emph{Total standard deviation}: the standard deviation over all non-hydrogen atoms in the residue
	\item \emph{Side chain mean}: the average over just non-hydrogen atoms in the residue side chain
	\item \emph{Side chain standard deviation}: the standard deviation over just non-hydrogen atoms in the residue side chain
	\item \emph{maximum}: the maximum over all non-hydrogen atoms
	\item \emph{minimum}: the minimum over all non-hydrogen atoms
\end{itemize}
All of these features are normalized to values between 0 and 1 on a per-protein basis.


\subsection{Hydrophobicity}
\noindent
\emph{Number of features}: 1

\noindent
\emph{External tools}: PSAIA~\cite{mihel2008}

\noindent
\emph{Description}:
Hydrophobicity indicates the tendency for an amino acid to avoid water.
PSAIA calculates this value base on the scale defined by Kyte and Doolittle, (1982)~\cite{kyte1982}.
Hydrophobicity values were normalized between 0 and 1 on a per-protein basis.


\subsection{Half Sphere Amino Acid Composition}
\noindent
\emph{Number of features}: 40

\noindent
\emph{External tools}:  None

\noindent
\emph{Description}:
These features capture the residue composition in a neighborhood of the residue of interest.
The neighborhood is defined as all residues with at least one atom closer than 8\AA{} to at least one atom in the residue of interest.
An array of counts is created which stores the number of each type of residue in the neighborhood, which is then divided by the total count of all types.
This array is calculated for two regions, separated by the null space of vector that is the average of the unit vectors from the alpha carbon to the side chain atoms.


\section{Edge Features}

\subsection{Average Atomic Distance}
\noindent
\emph{Number of features}: 1

\noindent
\emph{External tools}: None

\noindent
\emph{Description}:
This feature is computed by taking the average of the distance between any two atoms of the two residues of interest.
The raw distance is then passed through a Gaussian function: 

\begin{equation}
f(x) = e^{-x^2 / \sigma^2},
\end{equation}

\noindent
where sigma is chosen by model selection, so that this feature has a higher value for residues that are closer together.


\subsection{$\text{C C}_{\alpha} \text{O}$ Angle}
\noindent
\emph{Number of features}: 1

\noindent
\emph{External tools}: None

\noindent
\emph{Description}:
This feature captures the relative orientation of two residues as defined by the normals to their adjacent peptide planes.
Let $X_{C_{\alpha}}$, $X_{C}$, and $X_{O}$ be the positions vectors of the alpha carbon, carboxyl-group carbon, and carboxyl-group oxygen respectively.
The normal is then defined as:
\begin{equation}
\hat{N} = \frac{(X_{O} - X_{C}) \times  (X_{C_\alpha} - X_{C})}{||(X_{O} - X_{C}) \times  (X_{C_\alpha} - X_{C})||}, 
\end{equation}

\noindent
where $\times$ denotes the cross product, and $ || \cdot || $ the $\textsc{L}^2$ norm.
The angle between residues $i$ and $j$ is then:
\begin{equation}
\text{C C}_{\alpha} \text{O} = \text{cos}^{-1}\bigg(\frac{\hat{N_i} \cdot \hat{N_j}}{|| \hat{N_i} ||~|| \hat{N_j} || } \bigg)
\end{equation}

\noindent
Finally, the angle is normalized to be between 0 and 1 by dividing by $2 \pi$. 